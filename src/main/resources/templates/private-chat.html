<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Chat</title>
    <link rel="stylesheet" th:href="@{css/private-chat.css}">
</head>
<body>
<div class="chat-container">
    <div class="chat-header">
        <button class="back-button" onclick="goBack()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m12 19-7-7 7-7"/>
                <path d="m19 12H5"/>
            </svg>
        </button>
        <div class="chat-info">
            <div class="user-avatar">
                <span id="userInitial">?</span>
            </div>
            <div class="user-details">
                <div class="username" id="chatUsername">Loading...</div>
                <div class="status" id="userStatus">Connecting...</div>
            </div>
        </div>
        <div class="chat-actions">
            <button class="action-button" title="Call">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                </svg>
            </button>
            <button class="action-button" title="Video Call">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="23 7 16 12 23 17 23 7"/>
                    <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                </svg>
            </button>
        </div>
    </div>

    <div class="messages-container" id="messages">
        <!-- Messages will be populated by JavaScript -->
    </div>

    <div class="typing-indicator" id="typingStatus"></div>

    <div class="message-input-container">
        <div class="input-wrapper">
            <button class="attachment-button" title="Attach File">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66L9.64 16.2a2 2 0 0 1-2.83-2.83l8.49-8.49"/>
                </svg>
            </button>
            <input type="text" id="msgInput" placeholder="Type a message..." disabled autocomplete="off">
            <button class="emoji-button" title="Emoji">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="m9 9 1.5 1.5L12 9l1.5 1.5L15 9"/>
                    <path d="M8 15s1.5 2 4 2 4-2 4-2"/>
                </svg>
            </button>
            <button class="send-button" id="sendButton" onclick="sendMessage()" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"/>
                    <polygon points="22,2 15,22 11,13 2,9 22,2"/>
                </svg>
            </button>
        </div>
    </div>
</div>

<div class="connection-status" id="connectionStatus">
    <div class="status-indicator"></div>
    <span class="status-text">Connecting...</span>
</div>

<script th:src="@{js/presence.js}"></script> <!-- Global Ping Socket -->
<script th:src="@{js/private-chat.js}"></script>
</body>
</html>